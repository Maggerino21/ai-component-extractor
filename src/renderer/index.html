<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aquaculture AI Extractor</title>
    <link rel="stylesheet" href="styles.css">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval'; script-src 'self' 'unsafe-inline' 'unsafe-eval';">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üêü Aquaculture AI Component Extractor</h1>
            <p>AI-powered component extraction for fish farming facilities</p>
        </div>

        <div class="step-indicators">
            <div class="step-indicator" data-step="upload">
                üìÅ Upload Files
            </div>
            <div class="step-indicator" data-step="mapping">
                üó∫Ô∏è Position Mapping
            </div>
            <div class="step-indicator" data-step="supplier">
                üè≠ Select Supplier
            </div>
            <div class="step-indicator" data-step="processing">
                ü§ñ AI Processing
            </div>
            <div class="step-indicator" data-step="results">
                üìä Results
            </div>
        </div>

        <div id="uploadArea" class="content-area">
            <div class="upload-area" id="uploadDropZone">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text">
                    <h3>Drop Files Here</h3>
                    <p>Or click to select PDF and Excel documents</p>
                    <button id="selectFilesBtn" class="btn-primary">Select Files</button>
                </div>
            </div>

            <div id="fileList" class="file-list">
                <h4>Selected Files</h4>
                <ul id="selectedFiles"></ul>
                <div class="file-actions">
                    <button id="mappingBtn" class="btn-primary" disabled>Setup Position Mapping</button>
                    <button id="processBtn" class="btn-primary" disabled>Process with AI</button>
                    <button id="clearBtn" class="btn-secondary">Clear Files</button>
                </div>
            </div>
        </div>

        <div id="mappingArea" class="content-area">
            <div class="position-mapper">
                <div class="mapper-header">
                    <h3>Position Mapping Setup</h3>
                    <p>Configure your facility and map document references to internal positions</p>
                </div>
            </div>
        </div>

        <div id="supplierArea" class="content-area">
            <div class="supplier-selector">
                <div class="supplier-header">
                    <h3>üè≠ Select Primary Supplier (Optional)</h3>
                    <p>Facility: <strong id="supplierFacilityName"></strong></p>
                    <p>These are product catalog suppliers. Select one to focus AI extraction, or skip to use full catalog.</p>
                </div>
                
                <div class="supplier-search">
                    <input 
                        type="text" 
                        id="supplierSearchInput" 
                        placeholder="üîç Type at least 3 characters to search suppliers..." 
                        oninput="searchSuppliers(this.value)"
                        autofocus
                    />
                    <div id="supplierDropdown" class="dropdown-results"></div>
                </div>
                
                <div id="selectedSupplierDisplay" class="selected-supplier" style="display: none;">
                    <h4>Selected Supplier</h4>
                    <div class="supplier-card selected">
                        <h5 id="selectedSupplierName"></h5>
                        <p id="selectedSupplierDetails"></p>
                    </div>
                </div>
                
                <div class="supplier-actions">
                    <button onclick="skipSupplierSelection()" class="btn-primary">‚è≠Ô∏è Skip - Use Full Catalog</button>
                    <button onclick="proceedToProcessing()" id="proceedToProcessingBtn" class="btn-secondary" disabled>Continue with Selected Supplier</button>
                    <button onclick="backToMapping()" class="btn-secondary">‚¨ÖÔ∏è Back to Position Mapping</button>
                </div>
            </div>
        </div>

        <div id="processingArea" class="content-area">
            <div class="processing-status">
                <h3>üîÑ Processing Files with AI</h3>
                <p>Extracting components from your documents...</p>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progressBar" class="progress-fill"></div>
                    </div>
                    <div id="progressStatus" class="progress-status">Initializing...</div>
                </div>

                <div class="processing-details">
                    <div class="detail-item">
                        <span class="detail-label">Files:</span>
                        <span id="fileCount" class="detail-value">0</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Position Mappings:</span>
                        <span id="mappingCount" class="detail-value">0</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Status:</span>
                        <span id="currentStatus" class="detail-value">Waiting...</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="resultsArea" class="content-area">
        </div>

        <div class="app-footer">
            <div class="status-indicator">
                <span id="appStatus">Ready</span>
            </div>
            <div class="app-info">
                Aquaculture AI Extractor v1.0
            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>